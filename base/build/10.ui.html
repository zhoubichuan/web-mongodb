<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>十.删除文档 | MongoDB学习笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="个人总结的vuepress学习技术文档-语法">
    <meta name="keywords" content="vuepress,最新技术文档,vuepress语法,markdown语法">
    
    <link rel="preload" href="/web-mongodb/assets/css/0.styles.1221baa7.css" as="style"><link rel="preload" href="/web-mongodb/assets/js/app.46953e00.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/2.9c6df21b.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/1.c7999b22.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/27.ad4f56fc.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/19.3aa63867.js" as="script"><link rel="prefetch" href="/web-mongodb/assets/js/10.62935875.js"><link rel="prefetch" href="/web-mongodb/assets/js/11.0669fae1.js"><link rel="prefetch" href="/web-mongodb/assets/js/12.908037a8.js"><link rel="prefetch" href="/web-mongodb/assets/js/13.7d4249f0.js"><link rel="prefetch" href="/web-mongodb/assets/js/14.503c154e.js"><link rel="prefetch" href="/web-mongodb/assets/js/15.e940f298.js"><link rel="prefetch" href="/web-mongodb/assets/js/16.1641d976.js"><link rel="prefetch" href="/web-mongodb/assets/js/17.77cb064f.js"><link rel="prefetch" href="/web-mongodb/assets/js/18.b37cbc46.js"><link rel="prefetch" href="/web-mongodb/assets/js/20.d3bc44a7.js"><link rel="prefetch" href="/web-mongodb/assets/js/21.e85e9d90.js"><link rel="prefetch" href="/web-mongodb/assets/js/22.16e8f03b.js"><link rel="prefetch" href="/web-mongodb/assets/js/23.83664782.js"><link rel="prefetch" href="/web-mongodb/assets/js/24.cff610c9.js"><link rel="prefetch" href="/web-mongodb/assets/js/25.75ce52a8.js"><link rel="prefetch" href="/web-mongodb/assets/js/26.e7eab329.js"><link rel="prefetch" href="/web-mongodb/assets/js/28.1da3b40c.js"><link rel="prefetch" href="/web-mongodb/assets/js/29.6de9ee14.js"><link rel="prefetch" href="/web-mongodb/assets/js/3.9f5ca14c.js"><link rel="prefetch" href="/web-mongodb/assets/js/30.4388d6f8.js"><link rel="prefetch" href="/web-mongodb/assets/js/31.4b12d086.js"><link rel="prefetch" href="/web-mongodb/assets/js/32.e56d6931.js"><link rel="prefetch" href="/web-mongodb/assets/js/33.d5e0eadc.js"><link rel="prefetch" href="/web-mongodb/assets/js/34.a5bdc1f9.js"><link rel="prefetch" href="/web-mongodb/assets/js/35.c083b277.js"><link rel="prefetch" href="/web-mongodb/assets/js/36.c6294bab.js"><link rel="prefetch" href="/web-mongodb/assets/js/37.49f99c82.js"><link rel="prefetch" href="/web-mongodb/assets/js/38.0207d117.js"><link rel="prefetch" href="/web-mongodb/assets/js/39.7b511e6e.js"><link rel="prefetch" href="/web-mongodb/assets/js/4.5a212b2d.js"><link rel="prefetch" href="/web-mongodb/assets/js/40.18d654bc.js"><link rel="prefetch" href="/web-mongodb/assets/js/41.0764eab4.js"><link rel="prefetch" href="/web-mongodb/assets/js/42.9221178b.js"><link rel="prefetch" href="/web-mongodb/assets/js/43.dd6fe239.js"><link rel="prefetch" href="/web-mongodb/assets/js/44.13ebe8a4.js"><link rel="prefetch" href="/web-mongodb/assets/js/45.4f2f4d8f.js"><link rel="prefetch" href="/web-mongodb/assets/js/46.eb602e13.js"><link rel="prefetch" href="/web-mongodb/assets/js/47.c022f1db.js"><link rel="prefetch" href="/web-mongodb/assets/js/48.490caa90.js"><link rel="prefetch" href="/web-mongodb/assets/js/49.0ea69b84.js"><link rel="prefetch" href="/web-mongodb/assets/js/5.70f6abfa.js"><link rel="prefetch" href="/web-mongodb/assets/js/50.ca6ccc3d.js"><link rel="prefetch" href="/web-mongodb/assets/js/51.0294c615.js"><link rel="prefetch" href="/web-mongodb/assets/js/52.4ee4b94e.js"><link rel="prefetch" href="/web-mongodb/assets/js/53.467778b3.js"><link rel="prefetch" href="/web-mongodb/assets/js/54.8b3d7f73.js"><link rel="prefetch" href="/web-mongodb/assets/js/55.dcba9f56.js"><link rel="prefetch" href="/web-mongodb/assets/js/56.464bacc2.js"><link rel="prefetch" href="/web-mongodb/assets/js/57.a6b884de.js"><link rel="prefetch" href="/web-mongodb/assets/js/6.48f2ca4a.js"><link rel="prefetch" href="/web-mongodb/assets/js/7.6c1e9806.js"><link rel="prefetch" href="/web-mongodb/assets/js/vendors~docsearch.39676dd9.js">
    <link rel="stylesheet" href="/web-mongodb/assets/css/0.styles.1221baa7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web-mongodb/" class="home-link router-link-active"><!----> <span class="site-name">MongoDB学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/base/build/1.index.html" class="nav-link">
  一.基础学习
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/base/practice/1.index.html" class="nav-link">
  二.实战练习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/use/1.index.html" class="nav-link">
  一.项目实战
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/typeScript/1.index.html" class="nav-link">
  二.其他
</a></li></ul></div></div> <a href="https://gitee.com/zhoubichuan/web-mongodb" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/base/build/1.index.html" class="nav-link">
  一.基础学习
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/base/practice/1.index.html" class="nav-link">
  二.实战练习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/use/1.index.html" class="nav-link">
  一.项目实战
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/typeScript/1.index.html" class="nav-link">
  二.其他
</a></li></ul></div></div> <a href="https://gitee.com/zhoubichuan/web-mongodb" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/web-mongodb/base/build/1.index.html" class="sidebar-link">一.概要</a></li><li><a href="/web-mongodb/base/build/2.webpack.html" class="sidebar-link">二.安装方式</a></li><li><a href="/web-mongodb/base/build/3.file.html" class="sidebar-link">三.启动与连接</a></li><li><a href="/web-mongodb/base/build/4.single.html" class="sidebar-link">四.基本概念</a></li><li><a href="/web-mongodb/base/build/5.page.html" class="sidebar-link">五.数据库操作</a></li><li><a href="/web-mongodb/base/build/7.module.html" class="sidebar-link">六.集合操作</a></li><li><a href="/web-mongodb/base/build/8.project.html" class="sidebar-link">七.文档操作</a></li><li><a href="/web-mongodb/base/build/9.utils.html" class="sidebar-link">八.更新文档</a></li><li><a href="/web-mongodb/base/build/10.ui.html" aria-current="page" class="active sidebar-link">十.删除文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-查询文档" class="sidebar-link">11. 查询文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-1-find" class="sidebar-link">11.1 find</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-2-查询指定列" class="sidebar-link">11.2 查询指定列</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-3-findone" class="sidebar-link">11.3 findOne</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-4-in" class="sidebar-link">11.4 $in</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-5-nin" class="sidebar-link">11.5 $nin</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-6-not" class="sidebar-link">11.6 $not</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-7-array" class="sidebar-link">11.7 array</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-8-where" class="sidebar-link">11.8 where</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-9-cursor" class="sidebar-link">11.9 cursor</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-条件操作符" class="sidebar-link">12. 条件操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-1-大于操作符" class="sidebar-link">12.1 大于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-2-大于等于操作符" class="sidebar-link">12.2 大于等于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-3-小于操作符" class="sidebar-link">12.3 小于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-4-小于等于操作符" class="sidebar-link">12.4 小于等于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-5-同时使用-gte和-lte" class="sidebar-link">12.5 同时使用 $gte和$lte</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-6-等于" class="sidebar-link">12.6 等于</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-7-使用-id-进行查询" class="sidebar-link">12.7 使用 _id 进行查询</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-8-查询结果集的条数" class="sidebar-link">12.8 查询结果集的条数</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-9-正则匹配" class="sidebar-link">12.9 正则匹配</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-与和或" class="sidebar-link">13. 与和或</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-1-and" class="sidebar-link">13.1 and</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-2-or" class="sidebar-link">13.2 or</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-3-and-和-or-联用" class="sidebar-link">13.3 and 和 or 联用</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-分页查询" class="sidebar-link">14. 分页查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-1-limit" class="sidebar-link">14.1 limit</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-2-skip" class="sidebar-link">14.2 skip</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-3-skip-limit" class="sidebar-link">14.3 skip+limit</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-4-sort-排序" class="sidebar-link">14.4 sort 排序</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_15-执行脚本" class="sidebar-link">15. 执行脚本</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_16-备份与导出" class="sidebar-link">16. 备份与导出</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-权限" class="sidebar-link">17. 权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-1-创建用户" class="sidebar-link">17.1 创建用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-2-查询用户" class="sidebar-link">17.2 查询用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-3-删除用户" class="sidebar-link">17.3 删除用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-4-启动数据库权限检查" class="sidebar-link">17.4 启动数据库权限检查</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-5-鉴权" class="sidebar-link">17.5 鉴权</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-索引" class="sidebar-link">18. 索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-1-准备数据" class="sidebar-link">18.1 准备数据</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-2-打印出查询时间" class="sidebar-link">18.2 打印出查询时间</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-3-建立索引" class="sidebar-link">18.3 建立索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-附录" class="sidebar-link">19. 附录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-1-objectid-构成" class="sidebar-link">19.1 ObjectId 构成</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-2-mongodb-启动命令-mongod-参数说明" class="sidebar-link">19.2 Mongodb 启动命令 mongod 参数说明</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-3-集合命令" class="sidebar-link">19.3 集合命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-用户和权限" class="sidebar-link">20. 用户和权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-1-角色" class="sidebar-link">20.1 角色</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-2-权限配置" class="sidebar-link">20.2 权限配置</a></li></ul></li></ul></li><li><a href="/web-mongodb/base/build/11.data.html" class="sidebar-link">导入导出数据</a></li><li><a href="/web-mongodb/base/build/12.skill.html" class="sidebar-link">索引</a></li><li><a href="/web-mongodb/base/build/13.com.html" class="sidebar-link">主从复制</a></li><li><a href="/web-mongodb/base/build/14.data.html" class="sidebar-link">扩展 mongoose 模型</a></li><li><a href="/web-mongodb/base/build/15.api.html" class="sidebar-link">中间件</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="十-删除文档"><a href="#十-删除文档" class="header-anchor">#</a> 十.删除文档</h1> <div class="custom-block tip"><p class="custom-block-title">前言</p> <ul><li>remove:用来移除集合中的数据</li></ul></div> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>db.collection.remove<span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>, <span class="token comment"># query :（可选）删除的文档的条件</span>
   <span class="token punctuation">{</span>
     justOne: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span> <span class="token comment"># justOne : （可选）如果设为 true 或 1，则只删除匹配到的多个文档中的第一个</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>删除 worker 集合里 name 是 小明 2 的所有文档数据</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code> db.students.remove<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">'小明 2'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#  WriteResult({ &quot;nRemoved&quot; : 2 })</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>即使匹配多条也只删除一条</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>{name:<span class="token string">&quot;小明 2&quot;</span>}<span class="token punctuation">,</span>{justOne:<span class="token boolean">true</span>}<span class="token punctuation">)</span>
<span class="token comment">-- WriteResult({ &quot;nRemoved&quot; : 1 })</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_11-查询文档"><a href="#_11-查询文档" class="header-anchor">#</a> 11. 查询文档</h2> <h3 id="_11-1-find"><a href="#_11-1-find" class="header-anchor">#</a> 11.1 find</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collection_name 集合的名字
实例 查询 students 下所有的文档</p> <p>db.students.find()</p> <h3 id="_11-2-查询指定列"><a href="#_11-2-查询指定列" class="header-anchor">#</a> 11.2 查询指定列</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>{queryWhere}<span class="token punctuation">,</span>{<span class="token keyword">key</span>:<span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">key</span>:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数列表</p> <p>collection_name 集合的名字
queryWhere 参阅查询条件操作符
key 指定要返回的列
1 表示要显示
实例 只返回显示 age 列</p> <blockquote><p>db.students.find({},{age:1});</p></blockquote> <h3 id="_11-3-findone"><a href="#_11-3-findone" class="header-anchor">#</a> 11.3 findOne</h3> <p>查询匹配结果的第一条数据 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>实例</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-4-in"><a href="#_11-4-in" class="header-anchor">#</a> 11.4 $in</h3> <p>查询字段在某个范围内</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$<span class="token operator">in</span>:<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span>}}<span class="token punctuation">,</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-5-nin"><a href="#_11-5-nin" class="header-anchor">#</a> 11.5 $nin</h3> <p>查询字段不在某个范围内</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$nin:<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span>}}<span class="token punctuation">,</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-6-not"><a href="#_11-6-not" class="header-anchor">#</a> 11.6 $not</h3> <p>对特定条件取反</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$<span class="token operator">not</span>:{$gte:<span class="token number">20</span><span class="token punctuation">,</span>$lte:<span class="token number">30</span>}}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-7-array"><a href="#_11-7-array" class="header-anchor">#</a> 11.7 array</h3> <p>对数组的查询</p> <p>//按所有元素匹配
//let result = db.student.find({friends:[ &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot; ]});
//匹配一项 包含 A 的就可以
//let result = db.student.find({friends:&quot;A&quot;});
//$all 必须同时包含A B
//let result = db.student.find({friends:{$all:['A',&quot;B&quot;]}});
//$in 或者关系 ，包含A或者B
//let result = db.student.find({friends:{$in:['A',&quot;B&quot;]}});
//$size 按数组的长度去匹配
//let result = db.student.find({friends:{$size:4}});
//$slice 只返回数组中的某一部分
//let result = db.student.find({friends:{$size:5}},{name:1,friends:{$slice:2}});
//let result = db.student.find({friends:{$size:5}},{name:1,friends:{$slice:-2}});
$slice:[&quot;$array&quot;, [startIndex, ] length ] （startIndex可以省略，默认从0开始）
&quot;friends&quot; : [ &quot;A&quot;, &quot;B&quot; ] }   &quot;friends&quot; : [ &quot;C&quot;, &quot;D&quot; ]
db.stu.find({},{friends:{$slice:[0,3]}}); &quot;friends&quot; : [ &quot;A&quot;, &quot;B&quot;, &quot;C&quot; ]</p> <h3 id="_11-8-where"><a href="#_11-8-where" class="header-anchor">#</a> 11.8 where</h3> <p>db.student.find({$where:&quot;this.age&gt;30&quot;},{name:1,age:1});</p> <h3 id="_11-9-cursor"><a href="#_11-9-cursor" class="header-anchor">#</a> 11.9 cursor</h3> <p>游标不是查询结果，而是查询的一个返回资源或者接口，通过这个接口，可以逐条读取数据
var result = db.student.find();</p> <p>//while(result.hasNext()){
// printjson(result.next());
//}</p> <h2 id="_12-条件操作符"><a href="#_12-条件操作符" class="header-anchor">#</a> 12. 条件操作符</h2> <p>条件操作符用于比较两个表达式并从 mongoDB 集合中获取数据</p> <h3 id="_12-1-大于操作符"><a href="#_12-1-大于操作符" class="header-anchor">#</a> 12.1 大于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gt:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
查询 age 大于 30 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$gt:<span class="token number">30</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-2-大于等于操作符"><a href="#_12-2-大于等于操作符" class="header-anchor">#</a> 12.2 大于等于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
查询 age 3 大于等于 30 的数据</p> <p>db.students.find({age: {$gte: 30}})</p> <h3 id="_12-3-小于操作符"><a href="#_12-3-小于操作符" class="header-anchor">#</a> 12.3 小于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span> {<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lt:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
实例</p> <p>db.students.find({age: {$lt: 30}}) 查询 age 小于 30 的数据</p> <h3 id="_12-4-小于等于操作符"><a href="#_12-4-小于等于操作符" class="header-anchor">#</a> 12.4 小于等于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名词
key 字段
value 值
查询 age 小于等于 30 的数据</p> <p>db.students.find({age: {$lte: 30}})</p> <h3 id="_12-5-同时使用-gte和-lte"><a href="#_12-5-同时使用-gte和-lte" class="header-anchor">#</a> 12.5 同时使用 $gte和$lte</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}<span class="token punctuation">,</span><span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
实例 查询 age 大于等于 30 并且 age 小于等于 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age: {$gte: <span class="token number">30</span><span class="token punctuation">,</span> $lte: <span class="token number">50</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-6-等于"><a href="#_12-6-等于" class="header-anchor">#</a> 12.6 等于</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名词
key 字段
value 值
查询 age = 30 的数据</p> <p>db.students.find({&quot;age&quot;: 30})`</p> <h3 id="_12-7-使用-id-进行查询"><a href="#_12-7-使用-id-进行查询" class="header-anchor">#</a> 12.7 使用 _id 进行查询</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;_id&quot;</span> : ObjectId<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>value _id 的值
实例 查询_id 是 562af23062d5a57609133974 数据</p> <blockquote><p>db.students.find({_id:ObjectId(&quot;5adb666ecd738e9771638985&quot;)});</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>{ <span class="token string">&quot;_id&quot;</span> : ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5adb666ecd738e9771638985&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span> : <span class="token string">&quot;zzzz&quot;</span> }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-8-查询结果集的条数"><a href="#_12-8-查询结果集的条数" class="header-anchor">#</a> 12.8 查询结果集的条数</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
实例</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-9-正则匹配"><a href="#_12-9-正则匹配" class="header-anchor">#</a> 12.9 正则匹配</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token operator">/</span><span class="token keyword">value</span><span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
实例 查询 name 里包含 zhang 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token operator">/</span><span class="token keyword">value</span><span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询某个字段的值当中是否以另一个值开头</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token operator">/</span><span class="token operator">^</span>zhang<span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_13-与和或"><a href="#_13-与和或" class="header-anchor">#</a> 13. 与和或</h2> <h3 id="_13-1-and"><a href="#_13-1-and" class="header-anchor">#</a> 13.1 and</h3> <p>find 方法可以传入多个键(key)，每个键(key)以逗号隔开</p> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>{key1:value1<span class="token punctuation">,</span> key2:value2}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>实例 查询 name 是 小明 并且 age 是 1 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">'小明'</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_13-2-or"><a href="#_13-2-or" class="header-anchor">#</a> 13.2 or</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>
   {
      $<span class="token operator">or</span>: <span class="token punctuation">[</span>
   {key1: value1}<span class="token punctuation">,</span> {key2:value2}
      <span class="token punctuation">]</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>实例 查询 age = 30 或者 age = 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:<span class="token number">30</span>}<span class="token punctuation">,</span>{age:<span class="token number">50</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_13-3-and-和-or-联用"><a href="#_13-3-and-和-or-联用" class="header-anchor">#</a> 13.3 and 和 or 联用</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>
   {
     key1:value1<span class="token punctuation">,</span>
     key2:value2<span class="token punctuation">,</span>
     $<span class="token operator">or</span>: <span class="token punctuation">[</span>
   {key1: value1}<span class="token punctuation">,</span>
   {key2:value2}
     <span class="token punctuation">]</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>实例 查询 name 是 小明 并且 age 是 30 或者 age 是 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">'小明'</span><span class="token punctuation">,</span>$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:<span class="token number">30</span>}<span class="token punctuation">,</span>{age:<span class="token number">50</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_14-分页查询"><a href="#_14-分页查询" class="header-anchor">#</a> 14. 分页查询</h2> <h3 id="_14-1-limit"><a href="#_14-1-limit" class="header-anchor">#</a> 14.1 limit</h3> <p>读取指定数量的数据记录 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合
number 读取的条数
实例 查询前 3 条数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-2-skip"><a href="#_14-2-skip" class="header-anchor">#</a> 14.2 skip</h3> <p>跳过指定数量的数据，skip 方法同样接受一个数字参数作为跳过的记录条数 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>number<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合
number 跳过的条数
实例 查询 3 条以后的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-3-skip-limit"><a href="#_14-3-skip-limit" class="header-anchor">#</a> 14.3 skip+limit</h3> <p>通常用这种方式来实现分页功能 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>skipNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>limitNum<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
skipNum 跳过的条数
limitNum 限制返回的条数
实例 查询在 4-6 之间的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-4-sort-排序"><a href="#_14-4-sort-排序" class="header-anchor">#</a> 14.4 sort 排序</h3> <p>sort()方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而-1 是用于降序排列。 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token number">1</span>}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token operator">-</span><span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>参数</p> <p>collectoin_name 集合
key 表示字段
实例 查询出并升序排序 {age:1} age 表示按那个字段排序 1 表示升序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{age:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_15-执行脚本"><a href="#_15-执行脚本" class="header-anchor">#</a> 15. 执行脚本</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token string">&quot;小明&quot;</span>
<span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token string">&quot;123456&quot;</span>
<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> password <span class="token punctuation">}</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">)</span> <span class="token comment">//选择users数据库</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;write &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;小明&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> cost <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;cost &quot;</span> <span class="token operator">+</span> cost <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;小明&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
<span class="token keyword">var</span> cost <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;cost &quot;</span> <span class="token operator">+</span> cost <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>在命令行中执行</p> <p>script&gt;mongo 1.js
MongoDB shell version: 2.6.7
connecting to: test
connecting to: students
write WriteResult({ &quot;nInserted&quot; : 1 })</p> <h2 id="_16-备份与导出"><a href="#_16-备份与导出" class="header-anchor">#</a> 16. 备份与导出</h2> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>mongodump
-- <span class="token function">host</span> <span class="token number">127.0</span>.0.1
-- port <span class="token number">27017</span>
-- out D:/databack/backup
-- collection mycollection
-- db <span class="token builtin class-name">test</span>
-- username
-- password
//mongodump <span class="token parameter variable">--host</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">--port</span> <span class="token number">27017</span> <span class="token parameter variable">--out</span> ./backup <span class="token parameter variable">--collection</span> <span class="token function">users</span> <span class="token parameter variable">--db</span> students
//db.users.drop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mongorestore
<span class="token parameter variable">--host</span>
<span class="token parameter variable">--port</span>
<span class="token parameter variable">--username</span>
<span class="token parameter variable">--password</span>

// mongorestore <span class="token parameter variable">--host</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">--port</span> <span class="token number">27017</span> ./backup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_17-权限"><a href="#_17-权限" class="header-anchor">#</a> 17. 权限</h2> <h3 id="_17-1-创建用户"><a href="#_17-1-创建用户" class="header-anchor">#</a> 17.1 创建用户</h3> <p>使用 use admin 进入我们的 admin 库
使用 db.createUser 方法来创建集合</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
    <span class="token keyword">user</span>:<span class="token string">'小明'</span><span class="token punctuation">,</span>
    pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
    customData:{
        name:<span class="token string">'zhufengpeixun'</span><span class="token punctuation">,</span>
        email:<span class="token string">'zhufengpeixun@126.com'</span><span class="token punctuation">,</span>
        age:<span class="token number">9</span>
    }<span class="token punctuation">,</span>
    roles:<span class="token punctuation">[</span>
        {
          role:<span class="token string">'readWrite'</span><span class="token punctuation">,</span>
          db:<span class="token string">'school'</span>
        }<span class="token punctuation">,</span>
        <span class="token string">'read'</span>
    <span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_17-2-查询用户"><a href="#_17-2-查询用户" class="header-anchor">#</a> 17.2 查询用户</h3> <p>db.system.users.find();</p> <h3 id="_17-3-删除用户"><a href="#_17-3-删除用户" class="header-anchor">#</a> 17.3 删除用户</h3> <p>db.system.users.remove({user:'小明'});</p> <h3 id="_17-4-启动数据库权限检查"><a href="#_17-4-启动数据库权限检查" class="header-anchor">#</a> 17.4 启动数据库权限检查</h3> <p>mongod --auth
mongo -u 小明 -p 123456 127.0.0.1:27017/admin</p> <h3 id="_17-5-鉴权"><a href="#_17-5-鉴权" class="header-anchor">#</a> 17.5 鉴权</h3> <p>use admin;
db.auth('小明','小明');
正确返回 1，如果错误返回 0</p> <h2 id="_18-索引"><a href="#_18-索引" class="header-anchor">#</a> 18. 索引</h2> <h3 id="_18-1-准备数据"><a href="#_18-1-准备数据" class="header-anchor">#</a> 18.1 准备数据</h3> <p>var db = connect('school');//选择 users 数据库
var users = [];
for(var i=0;i&lt;20;i++){
users.push({_id:i,name:'小明'+i});
}
print(users.length);
db.users.insert(users);</p> <h3 id="_18-2-打印出查询时间"><a href="#_18-2-打印出查询时间" class="header-anchor">#</a> 18.2 打印出查询时间</h3> <p>var startTime = Date.now();
var db = connect('school');<br>
var records=db.users.find({name:&quot;小明 100&quot;});
records.forEach(function(item){printjson(item)});
print(Date.now() - startTime);</p> <h3 id="_18-3-建立索引"><a href="#_18-3-建立索引" class="header-anchor">#</a> 18.3 建立索引</h3> <p>db.users.ensureIndex({name:1});</p> <h2 id="_19-附录"><a href="#_19-附录" class="header-anchor">#</a> 19. 附录</h2> <h3 id="_19-1-objectid-构成"><a href="#_19-1-objectid-构成" class="header-anchor">#</a> 19.1 ObjectId 构成</h3> <p>之前我们使用 MySQL 等关系型数据库时，主键都是设置成自增的。但在分布式环境下，这种方法就不可行了，会产生冲突。为此，MongoDB 采用了一个称之为 ObjectId 的类型来做主键。ObjectId 是一个 12 字节的 BSON 类型字符串。按照字节顺序，一次代表：</p> <p>4 字节：UNIX 时间戳
3 字节：表示运行 MongoDB 的机器
2 字节：表示生成此_id 的进程
3 字节：由一个随机数开始的计数器生成的值</p> <h3 id="_19-2-mongodb-启动命令-mongod-参数说明"><a href="#_19-2-mongodb-启动命令-mongod-参数说明" class="header-anchor">#</a> 19.2 Mongodb 启动命令 mongod 参数说明</h3> <p>选项 含义
--port 指定服务端口号，默认端口 27017
--logpath 指定 MongoDB 日志文件，注意是指定文件不是目录
--logappend 使用追加的方式写日志
--dbpath 指定数据库路径
--directoryperdb 设置每个数据库将被保存在一个单独的目录</p> <h3 id="_19-3-集合命令"><a href="#_19-3-集合命令" class="header-anchor">#</a> 19.3 集合命令</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>help<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
DBCollection help
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>help<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">show</span> DBCursor help 显示游标帮助
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 显示条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>copyTo<span class="token punctuation">(</span>newColl<span class="token punctuation">)</span> <span class="token operator">-</span> duplicates collection <span class="token keyword">by</span> copying <span class="token keyword">all</span> docum ents <span class="token keyword">to</span> newColl<span class="token punctuation">;</span> <span class="token keyword">no</span> indexes are copied<span class="token punctuation">.</span> 把一个旧集合拷贝到一个新的集合，不拷贝索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>convertToCapped<span class="token punctuation">(</span>maxBytes<span class="token punctuation">)</span> <span class="token operator">-</span> calls {convertToCapped:<span class="token string">'students '</span><span class="token punctuation">,</span> size:maxBytes}} command
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dataSize<span class="token punctuation">(</span><span class="token punctuation">)</span> 数据大小
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">distinct</span><span class="token punctuation">(</span> <span class="token keyword">key</span> <span class="token punctuation">)</span> <span class="token operator">-</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">distinct</span><span class="token punctuation">(</span> <span class="token string">'x'</span> <span class="token punctuation">)</span> 统计唯一的<span class="token keyword">key</span>的数量
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">drop</span> the collection ，删除集合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span><span class="token keyword">index</span><span class="token punctuation">)</span> <span class="token operator">-</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span> <span class="token string">&quot;indexName&quot;</span> <span class="token punctuation">)</span> 删除索引 <span class="token operator">or</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span> { <span class="token string">&quot;indexKey&quot;</span> : <span class="token number">1</span> } <span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span> 删除 所有的索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>ensureIndex<span class="token punctuation">(</span>keypattern<span class="token punctuation">[</span><span class="token punctuation">,</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> options <span class="token operator">is</span> an object wit h these possible <span class="token keyword">fields</span>: name<span class="token punctuation">,</span> <span class="token keyword">unique</span><span class="token punctuation">,</span> dropDups 添加索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>reIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">[</span>query<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token keyword">fields</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> query <span class="token operator">is</span> an optional query filter<span class="token punctuation">.</span> <span class="token keyword">fields</span> <span class="token operator">is</span> optional <span class="token keyword">set</span> <span class="token keyword">of</span> <span class="token keyword">fields</span> <span class="token keyword">to</span> <span class="token keyword">return</span><span class="token punctuation">.</span> 查找文档
     e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span> {x:
<span class="token number">77</span>} <span class="token punctuation">,</span> {name:<span class="token number">1</span><span class="token punctuation">,</span> x:<span class="token number">1</span>} <span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 数量
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> 限制返回的条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>n<span class="token punctuation">)</span> 设置跳过的条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 排序
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">[</span>query<span class="token punctuation">]</span><span class="token punctuation">)</span> 查找一条
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findAndModify<span class="token punctuation">(</span> { <span class="token keyword">update</span> : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> remove : <span class="token keyword">bool</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> query: {}<span class="token punctuation">,</span> sort: {}<span class="token punctuation">,</span> <span class="token string">'new'</span>: <span class="token boolean">false</span><span class="token punctuation">]</span> } <span class="token punctuation">)</span> 查找并且修改 更新后的值，是否删除，查询条件 排序 是否返回新值
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getDB<span class="token punctuation">(</span><span class="token punctuation">)</span> get DB object associated <span class="token keyword">with</span> collection 获得DB
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getPlanCache<span class="token punctuation">(</span><span class="token punctuation">)</span> get query <span class="token keyword">plan</span> cache associated <span class="token keyword">with</span> collecti <span class="token keyword">on</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span> 获取索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">(</span> { <span class="token keyword">key</span> : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> initial: <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> reduce : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">,</span> cond: <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> } <span class="token punctuation">)</span> 分组统计
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 插入文档
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>mapReduce<span class="token punctuation">(</span> mapFunction <span class="token punctuation">,</span> reduceFunction <span class="token punctuation">,</span> <span class="token punctuation">)</span> 统计
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span> <span class="token punctuation">[</span>pipeline<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">-</span> performs an agg regation <span class="token keyword">on</span> a collection<span class="token punctuation">;</span> <span class="token keyword">returns</span> a <span class="token keyword">cursor</span> 聚合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>query<span class="token punctuation">)</span> 删除
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>renameCollection<span class="token punctuation">(</span> newName <span class="token punctuation">,</span> <span class="token punctuation">)</span> renames the colle ction<span class="token punctuation">.</span> 重命名集合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>runCommand<span class="token punctuation">(</span> name <span class="token punctuation">,</span> <span class="token punctuation">)</span> runs a db command <span class="token keyword">with</span> the gi ven name <span class="token keyword">where</span> the <span class="token keyword">first</span> param <span class="token operator">is</span> the collection name
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">save</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 保存对象
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>stats<span class="token punctuation">(</span><span class="token punctuation">)</span> 统计信息
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>storageSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> includes free space allocated <span class="token keyword">to</span> this collec tion
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>totalIndexSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> size <span class="token operator">in</span> bytes <span class="token keyword">of</span> <span class="token keyword">all</span> the indexes
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>totalSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> storage allocated <span class="token keyword">for</span> <span class="token keyword">all</span> <span class="token keyword">data</span> <span class="token operator">and</span> indexes
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> object<span class="token punctuation">[</span><span class="token punctuation">,</span> upsert_bool<span class="token punctuation">,</span> multi_bool<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> instead o f two flags<span class="token punctuation">,</span> you can pass an object <span class="token keyword">with</span> <span class="token keyword">fields</span>: upsert<span class="token punctuation">,</span> multi 更新
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>validate<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> SLOW
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getShardVersion<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> only <span class="token keyword">for</span> <span class="token keyword">use</span> <span class="token keyword">with</span> sharding
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getShardDistribution<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> prints <span class="token keyword">statistics</span> about <span class="token keyword">data</span> distri bution <span class="token operator">in</span> the cluster
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getSplitKeysForChunks<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> calculates split p oints <span class="token keyword">over</span> <span class="token keyword">all</span> chunks <span class="token operator">and</span> <span class="token keyword">returns</span> splitter <span class="token keyword">function</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getWriteConcern<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">returns</span> the <span class="token keyword">write</span> concern used <span class="token keyword">for</span> <span class="token keyword">any</span> o perations <span class="token keyword">on</span> this collection<span class="token punctuation">,</span> inherited <span class="token keyword">from</span> server<span class="token operator">/</span>db <span class="token keyword">if</span> <span class="token keyword">set</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>setWriteConcern<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> sets the <span class="token keyword">write</span> conc ern <span class="token keyword">for</span> writes <span class="token keyword">to</span> the collection
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>unsetWriteConcern<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> unsets the <span class="token keyword">write</span> concern <span class="token keyword">for</span> writes <span class="token keyword">to</span> the collection
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_20-用户和权限"><a href="#_20-用户和权限" class="header-anchor">#</a> 20. 用户和权限</h2> <h3 id="_20-1-角色"><a href="#_20-1-角色" class="header-anchor">#</a> 20.1 角色</h3> <h4 id="_20-1-1-数据库用户角色"><a href="#_20-1-1-数据库用户角色" class="header-anchor">#</a> 20.1.1 数据库用户角色</h4> <p>针对每一个数据库进行控制。</p> <ul><li>read :提供了读取所有非系统集合，以及系统集合中的 system.indexes, system.js, system.namespaces</li> <li>readWrite: 包含了所有 read 权限，以及修改所有非系统集合的和系统集合中的 system.js 的权限</li></ul> <h4 id="_20-1-2-数据库管理角色"><a href="#_20-1-2-数据库管理角色" class="header-anchor">#</a> 20.1.2 数据库管理角色</h4> <p>每一个数据库包含了下面的数据库管理角色。</p> <ul><li>dbOwner：该数据库的所有者，具有该数据库的全部权限。</li> <li>dbAdmin：一些数据库对象的管理操作，但是没有数据库的读写权限。（参考：<a href="http://docs.mongodb.org/manual/reference/built-in-roles/#dbAdmin%EF%BC%89" target="_blank" rel="noopener noreferrer">http://docs.mongodb.org/manual/reference/built-in-roles/#dbAdmin）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>userAdmin：为当前用户创建、修改用户和角色。拥有 userAdmin 权限的用户可以将该数据库的任意权限赋予任意的用户。</li></ul> <h4 id="_20-1-3-集群管理权限"><a href="#_20-1-3-集群管理权限" class="header-anchor">#</a> 20.1.3 集群管理权限</h4> <ul><li>admin 数据库包含了下面的角色，用户管理整个系统，而非单个数据库。这些权限包含了复制集和共享集群的管理函数。</li> <li>clusterAdmin：提供了最大的集群管理功能。相当于 clusterManager, clusterMonitor, and hostManager 和 dropDatabase 的权限组合。</li> <li>clusterManager：提供了集群和复制集管理和监控操作。拥有该权限的用户可以操作 config 和 local 数据库（即分片和复制功能）</li> <li>clusterMonitor：仅仅监控集群和复制集。</li> <li>hostManager：提供了监控和管理服务器的权限，包括 shutdown 节点，logrotate, repairDatabase 等。 备份恢复权限：admin 数据库中包含了备份恢复数据的角色。包括 backup、restore 等等。</li></ul> <h4 id="_20-1-4-所有数据库角色"><a href="#_20-1-4-所有数据库角色" class="header-anchor">#</a> 20.1.4 所有数据库角色</h4> <ul><li>admin 数据库提供了一个 mongod 实例中所有数据库的权限角色：</li> <li>readAnyDatabase：具有 read 每一个数据库权限。但是不包括应用到集群中的数据库。</li> <li>readWriteAnyDatabase：具有 readWrite 每一个数据库权限。但是不包括应用到集群中的数据库。</li> <li>userAdminAnyDatabase：具有 userAdmin 每一个数据库权限，但是不包括应用到集群中的数据库。</li> <li>dbAdminAnyDatabase：提供了 dbAdmin 每一个数据库权限，但是不包括应用到集群中的数据库。</li></ul> <h4 id="_20-1-5-超级管理员权限"><a href="#_20-1-5-超级管理员权限" class="header-anchor">#</a> 20.1.5 超级管理员权限</h4> <p>root: dbadmin 到 admin 数据库、useradmin 到 admin 数据库以及 UserAdminAnyDatabase。但它不具有备份恢复、直接操作 system.*集合的权限，但是拥有 root 权限的超级用户可以自己给自己赋予这些权限。</p> <h4 id="_20-1-6-备份恢复角色"><a href="#_20-1-6-备份恢复角色" class="header-anchor">#</a> 20.1.6 备份恢复角色</h4> <p>backup、restore；</p> <h4 id="_20-1-7-内部角色"><a href="#_20-1-7-内部角色" class="header-anchor">#</a> 20.1.7 内部角色</h4> <p>__system</p> <h3 id="_20-2-权限配置"><a href="#_20-2-权限配置" class="header-anchor">#</a> 20.2 权限配置</h3> <ul><li>数据库用户角色 read readWrite</li> <li>数据库管理角色 dbAdmin dbOwner userAdmin</li> <li>集群管理角色 clusterAdmin clusterManager clusterMonitor hostManager</li> <li>备份恢复角色 backup restore</li> <li>所有数据库角色 readAnyDatabase readWriteAnyDatabase userAdminAnyDatabase dbAdminAnyDatabase</li> <li>超级用户角色 root</li></ul> <p>mongod.conf 配置文件</p> <h4 id="_20-2-1-常见命令"><a href="#_20-2-1-常见命令" class="header-anchor">#</a> 20.2.1 常见命令</h4> <p>ps -ef | grep mongo //查看当前进程
/usr/bin/mongod -f /etc/mongod.conf //寻找配置文件
systemctl restart mongod.service //重启 mongodb</p> <h4 id="_20-2-2-创建超级管理员"><a href="#_20-2-2-创建超级管理员" class="header-anchor">#</a> 20.2.2 创建超级管理员</h4> <p>show users //显示所有用户</p> <h4 id="_20-2-3-创建用户"><a href="#_20-2-3-创建用户" class="header-anchor">#</a> 20.2.3 创建用户</h4> <p>use admin</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
  <span class="token keyword">user</span>:<span class="token string">'admin'</span><span class="token punctuation">,</span>
  pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
  roles:<span class="token punctuation">[</span>{role:<span class="token string">'root'</span><span class="token punctuation">,</span>db:<span class="token string">'admin'</span>}<span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_20-2-4-管理员登录"><a href="#_20-2-4-管理员登录" class="header-anchor">#</a> 20.2.4 管理员登录</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>mongo admin <span class="token parameter variable">-u</span> admin <span class="token parameter variable">-p</span> <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_20-2-5-给每个库创创建一个自己的管理员"><a href="#_20-2-5-给每个库创创建一个自己的管理员" class="header-anchor">#</a> 20.2.5 给每个库创创建一个自己的管理员</h4> <p>use question;</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
  <span class="token keyword">user</span>:<span class="token string">'questionadmin'</span><span class="token punctuation">,</span>
  pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
  roles:<span class="token punctuation">[</span>{role:<span class="token string">'dbOwner'</span><span class="token punctuation">,</span>db:<span class="token string">'question'</span>}<span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_20-2-6-删除用户"><a href="#_20-2-6-删除用户" class="header-anchor">#</a> 20.2.6 删除用户</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>dropUser<span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// 删除某个用户,接受字符串参数</span>
db<span class="token punctuation">.</span>dropAllUser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 删除当前库的所有用户</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_20-2-7-更新用户"><a href="#_20-2-7-更新用户" class="header-anchor">#</a> 20.2.7 更新用户</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>updateUser<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span>{pwd:<span class="token string">'password'</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_20-2-8-密码认证"><a href="#_20-2-8-密码认证" class="header-anchor">#</a> 20.2.8 密码认证</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://gitee.com/zhoubichuan/web-mongodb/edit/master/src/base/build/10.ui.md" target="_blank" rel="noopener noreferrer">在gitee上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/12/11 13:00:52</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web-mongodb/base/build/9.utils.html" class="prev">
        八.更新文档
      </a></span> <span class="next"><a href="/web-mongodb/base/build/11.data.html">
        导入导出数据
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/web-mongodb/assets/js/app.46953e00.js" defer></script><script src="/web-mongodb/assets/js/2.9c6df21b.js" defer></script><script src="/web-mongodb/assets/js/1.c7999b22.js" defer></script><script src="/web-mongodb/assets/js/27.ad4f56fc.js" defer></script><script src="/web-mongodb/assets/js/19.3aa63867.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础知识 | MongoDB学习笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="个人总结的vuepress学习技术文档-语法">
    <meta name="keywords" content="vuepress,最新技术文档,vuepress语法,markdown语法">
    
    <link rel="preload" href="/web-mongodb/assets/css/0.styles.412a3f04.css" as="style"><link rel="preload" href="/web-mongodb/assets/js/app.418d3c31.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/2.1ee4d6d3.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/10.54fb086f.js" as="script"><link rel="preload" href="/web-mongodb/assets/js/3.0c6458ad.js" as="script"><link rel="prefetch" href="/web-mongodb/assets/js/11.921b2312.js"><link rel="prefetch" href="/web-mongodb/assets/js/12.66cf4b4a.js"><link rel="prefetch" href="/web-mongodb/assets/js/13.0eca9051.js"><link rel="prefetch" href="/web-mongodb/assets/js/14.850db4f3.js"><link rel="prefetch" href="/web-mongodb/assets/js/15.77991594.js"><link rel="prefetch" href="/web-mongodb/assets/js/16.3d7627c7.js"><link rel="prefetch" href="/web-mongodb/assets/js/17.a3b857f7.js"><link rel="prefetch" href="/web-mongodb/assets/js/18.dfffe59f.js"><link rel="prefetch" href="/web-mongodb/assets/js/19.552a9cfb.js"><link rel="prefetch" href="/web-mongodb/assets/js/20.c2bc8234.js"><link rel="prefetch" href="/web-mongodb/assets/js/21.d5dabce3.js"><link rel="prefetch" href="/web-mongodb/assets/js/22.92e4a915.js"><link rel="prefetch" href="/web-mongodb/assets/js/23.c8b798e8.js"><link rel="prefetch" href="/web-mongodb/assets/js/24.bb851deb.js"><link rel="prefetch" href="/web-mongodb/assets/js/25.0051b9bc.js"><link rel="prefetch" href="/web-mongodb/assets/js/26.6c30b6a3.js"><link rel="prefetch" href="/web-mongodb/assets/js/27.2d9ca7bc.js"><link rel="prefetch" href="/web-mongodb/assets/js/28.75965250.js"><link rel="prefetch" href="/web-mongodb/assets/js/29.92b0b466.js"><link rel="prefetch" href="/web-mongodb/assets/js/30.e7e74d03.js"><link rel="prefetch" href="/web-mongodb/assets/js/31.fbfd05b4.js"><link rel="prefetch" href="/web-mongodb/assets/js/32.182d60ec.js"><link rel="prefetch" href="/web-mongodb/assets/js/33.3e435e28.js"><link rel="prefetch" href="/web-mongodb/assets/js/34.22c12421.js"><link rel="prefetch" href="/web-mongodb/assets/js/35.cc3101d6.js"><link rel="prefetch" href="/web-mongodb/assets/js/36.ea5c4a9b.js"><link rel="prefetch" href="/web-mongodb/assets/js/37.7d7399fb.js"><link rel="prefetch" href="/web-mongodb/assets/js/38.0665076d.js"><link rel="prefetch" href="/web-mongodb/assets/js/39.316ef617.js"><link rel="prefetch" href="/web-mongodb/assets/js/4.62f13161.js"><link rel="prefetch" href="/web-mongodb/assets/js/40.7e856aa0.js"><link rel="prefetch" href="/web-mongodb/assets/js/41.80a981fd.js"><link rel="prefetch" href="/web-mongodb/assets/js/42.38b8c316.js"><link rel="prefetch" href="/web-mongodb/assets/js/5.b968e2ce.js"><link rel="prefetch" href="/web-mongodb/assets/js/6.2d1f614c.js"><link rel="prefetch" href="/web-mongodb/assets/js/7.5e217abe.js"><link rel="prefetch" href="/web-mongodb/assets/js/8.e796c565.js"><link rel="prefetch" href="/web-mongodb/assets/js/9.9a04d820.js">
    <link rel="stylesheet" href="/web-mongodb/assets/css/0.styles.412a3f04.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web-mongodb/" class="home-link router-link-active"><!----> <span class="site-name">MongoDB学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/base/build/1.config.html" class="nav-link">
  1.MongoDB实践指南
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/base/practice/1.MongoDB.html" class="nav-link">
  2.MongoDB相关实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/use/1.recursionAndDynamics.html" class="nav-link">
  1.组件精讲
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/typeScript/inde.html" class="nav-link">
  2.TypeScript
</a></li></ul></div></div> <a href="https://github.com/zhoubichuan/web-mongodb" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/base/build/1.config.html" class="nav-link">
  1.MongoDB实践指南
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/base/practice/1.MongoDB.html" class="nav-link">
  2.MongoDB相关实践
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/use/1.recursionAndDynamics.html" class="nav-link">
  1.组件精讲
</a></li><li class="dropdown-item"><!----> <a href="/web-mongodb/senior/typeScript/inde.html" class="nav-link">
  2.TypeScript
</a></li></ul></div></div> <a href="https://github.com/zhoubichuan/web-mongodb" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/web-mongodb/base/build/1.config.html" class="sidebar-link">1.什么是 MongoDB</a></li><li><a href="/web-mongodb/base/build/2.webpack.html" class="sidebar-link">二.MongoDB 安装</a></li><li><a href="/web-mongodb/base/build/3.file.html" class="sidebar-link">3.MongoDB 启动与连接</a></li><li><a href="/web-mongodb/base/build/4.single.html" class="sidebar-link">4.MongoDB 基本概念</a></li><li><a href="/web-mongodb/base/build/5.page.html" class="sidebar-link">5.数据库操作</a></li><li><a href="/web-mongodb/base/build/7.module.html" class="sidebar-link">6.集合操作</a></li><li><a href="/web-mongodb/base/build/8.project.html" class="sidebar-link">7.插入文档</a></li><li><a href="/web-mongodb/base/build/9.utils.html" class="sidebar-link">更新文档</a></li><li><a href="/web-mongodb/base/build/10.ui.html" aria-current="page" class="active sidebar-link">基础知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_1-什么是mongodb" class="sidebar-link">1. 什么是MongoDB</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_2-mongodb安装" class="sidebar-link">2. MongoDB安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_2-1-windows安装" class="sidebar-link">2.1 windows安装</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_2-2-mac安装" class="sidebar-link">2.2 mac安装</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_3-mongodb启动与连接" class="sidebar-link">3. mongodb启动与连接</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_3-1-windows启动服务器端" class="sidebar-link">3.1 windows启动服务器端</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_4-添加到window服务" class="sidebar-link">4. 添加到window服务</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_4-mongodb基本概念" class="sidebar-link">4. MongoDB基本概念</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_5-数据库操作" class="sidebar-link">5. 数据库操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_5-1-使用数据库" class="sidebar-link">5.1 使用数据库</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_5-2-查看所有数据库" class="sidebar-link">5.2 查看所有数据库</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_5-3-查看当前使用的数据库" class="sidebar-link">5.3 查看当前使用的数据库</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_5-4-删除数据库" class="sidebar-link">5.4 删除数据库</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_6-集合操作" class="sidebar-link">6. 集合操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_6-1-查看集合帮助" class="sidebar-link">6.1 查看集合帮助</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_6-2-查看数据库下的集合" class="sidebar-link">6.2 查看数据库下的集合</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_6-3-创建集合" class="sidebar-link">6.3 创建集合</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_7-插入文档" class="sidebar-link">7. 插入文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_7-1-insert" class="sidebar-link">7.1 insert</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_7-2-save" class="sidebar-link">7.2 save</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_8-更新文档" class="sidebar-link">8. 更新文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_8-1-语法" class="sidebar-link">8.1 语法</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_8-2-参数" class="sidebar-link">8.2 参数</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_8-3-upsert" class="sidebar-link">8.3 upsert</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_8-4-multi" class="sidebar-link">8.4 multi</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-更新操作符" class="sidebar-link">9. 更新操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-1-set" class="sidebar-link">9.1 $set</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-2-inc" class="sidebar-link">9.2 $inc</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-3-unset" class="sidebar-link">9.3 $unset</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-4-push" class="sidebar-link">9.4 $push</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-5-ne" class="sidebar-link">9.5 $ne</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-5-addtoset" class="sidebar-link">9.5 $addToSet</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-6-pull" class="sidebar-link">9.6 $pull</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-7-each" class="sidebar-link">9.7 $each</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-8-pop" class="sidebar-link">9.8 $pop</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_9-9-修改指定索引元素" class="sidebar-link">9.9 修改指定索引元素</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_10-文档的删除" class="sidebar-link">10. 文档的删除</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_10-1-语法" class="sidebar-link">10.1 语法</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_10-2-参数" class="sidebar-link">10.2 参数</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_10-3-实例" class="sidebar-link">10.3 实例</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-查询文档" class="sidebar-link">11. 查询文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-1-find" class="sidebar-link">11.1 find</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-2-查询指定列" class="sidebar-link">11.2 查询指定列</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-3-findone" class="sidebar-link">11.3 findOne</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-4-in" class="sidebar-link">11.4 $in</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-5-nin" class="sidebar-link">11.5 $nin</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-6-not" class="sidebar-link">11.6 $not</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-7-array" class="sidebar-link">11.7 array</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-8-where" class="sidebar-link">11.8 where</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_11-9-cursor" class="sidebar-link">11.9 cursor</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-条件操作符" class="sidebar-link">12. 条件操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-1-大于操作符" class="sidebar-link">12.1 大于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-2-大于等于操作符" class="sidebar-link">12.2 大于等于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-3-小于操作符" class="sidebar-link">12.3 小于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-4-小于等于操作符" class="sidebar-link">12.4 小于等于操作符</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-5-同时使用-gte和-lte" class="sidebar-link">12.5 同时使用 $gte和$lte</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-6-等于" class="sidebar-link">12.6 等于</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-7-使用-id进行查询" class="sidebar-link">12.7 使用 _id进行查询</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-8-查询结果集的条数" class="sidebar-link">12.8 查询结果集的条数</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_12-9-正则匹配" class="sidebar-link">12.9 正则匹配</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-与和或" class="sidebar-link">13. 与和或</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-1-and" class="sidebar-link">13.1 and</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-2-or" class="sidebar-link">13.2 or</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_13-3-and和or联用" class="sidebar-link">13.3 and和or联用</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-分页查询" class="sidebar-link">14. 分页查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-1-limit" class="sidebar-link">14.1 limit</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-2-skip" class="sidebar-link">14.2 skip</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-3-skip-limit" class="sidebar-link">14.3 skip+limit</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_14-4-sort排序" class="sidebar-link">14.4 sort排序</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_15-执行脚本" class="sidebar-link">15. 执行脚本</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_16-备份与导出" class="sidebar-link">16. 备份与导出</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-权限" class="sidebar-link">17. 权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-1-创建用户" class="sidebar-link">17.1 创建用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-2-查询用户" class="sidebar-link">17.2 查询用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-3-删除用户" class="sidebar-link">17.3 删除用户</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-4-启动数据库权限检查" class="sidebar-link">17.4 启动数据库权限检查</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_17-5-鉴权" class="sidebar-link">17.5 鉴权</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-索引" class="sidebar-link">18. 索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-1-准备数据" class="sidebar-link">18.1 准备数据</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-2-打印出查询时间" class="sidebar-link">18.2 打印出查询时间</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_18-3-建立索引" class="sidebar-link">18.3 建立索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-附录" class="sidebar-link">19. 附录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-1-objectid构成" class="sidebar-link">19.1 ObjectId构成</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-2-mongodb启动命令mongod参数说明" class="sidebar-link">19.2 Mongodb启动命令mongod参数说明</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_19-3-集合命令" class="sidebar-link">19.3 集合命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-用户和权限" class="sidebar-link">20. 用户和权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-1-角色" class="sidebar-link">20.1 角色</a></li><li class="sidebar-sub-header"><a href="/web-mongodb/base/build/10.ui.html#_20-2-权限配置" class="sidebar-link">20.2 权限配置</a></li></ul></li></ul></li><li><a href="/web-mongodb/base/build/11.data.html" class="sidebar-link">基础 2</a></li><li><a href="/web-mongodb/base/build/12.skill.html" class="sidebar-link">基础3</a></li><li><a href="/web-mongodb/base/build/13.com.html" class="sidebar-link">基础4</a></li><li><a href="/web-mongodb/base/build/14.data.html" class="sidebar-link">基础5</a></li><li><a href="/web-mongodb/base/build/15.api.html" class="sidebar-link">/base/build/15.api.html</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h1> <h2 id="_1-什么是mongodb"><a href="#_1-什么是mongodb" class="header-anchor">#</a> 1. 什么是MongoDB</h2> <ul><li>MongoDB是一个基于分布式文件存储的开源数据库系统</li> <li>MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</li></ul> <h2 id="_2-mongodb安装"><a href="#_2-mongodb安装" class="header-anchor">#</a> 2. MongoDB安装</h2> <h3 id="_2-1-windows安装"><a href="#_2-1-windows安装" class="header-anchor">#</a> 2.1 windows安装</h3> <p>Windows官方安装指南</p> <p>mongodb32位安装版 链接: https://pan.baidu.com/s/1SHJ1vre_CQOE3u-W0zniqQ 密码: chan</p> <p>MongoDB64位绿色版 链接: https://pan.baidu.com/s/1EkAB2SrcU1mfMfff_WDxtA 密码: w913</p> <p>mongo客户端 链接: https://pan.baidu.com/s/1YFxLZ-55D-WFR8os2fXN0A 密码: 61qd</p> <h3 id="_2-2-mac安装"><a href="#_2-2-mac安装" class="header-anchor">#</a> 2.2 mac安装</h3> <ul><li>Mac官方安装指南</li> <li>先安装homebrew</li> <li>http://brew.sh/</li> <li>使用brew安装mongodb</li> <li>brew install mongodb</li> <li>再安装可视化工具 Robomongo</li></ul> <h2 id="_3-mongodb启动与连接"><a href="#_3-mongodb启动与连接" class="header-anchor">#</a> 3. mongodb启动与连接</h2> <h3 id="_3-1-windows启动服务器端"><a href="#_3-1-windows启动服务器端" class="header-anchor">#</a> 3.1 windows启动服务器端</h3> <ul><li><p>找到mongodb安装目录,一般是 C:\Program Files\MongoDB 2.6 Standard\bin</p></li> <li><p>按下Shift+鼠标右键,选择在此处打开命令窗口</p></li> <li><p>在除C盘外的盘符新建一个空目录,如 D:\Mongodb\data</p></li> <li><p>在命令行中输入mongod --dbpath=刚创建的空目录,如</p></li> <li><p>mongod --dbpath=D:\Mongodb\data</p></li> <li><p>再按回车键</p></li> <li><p>如果出现waiting for connections on port 27017就表示启动成功,已经在27017端口上监听了客户端的请求</p></li> <li><p>注意：--dbpath后的值表示数据库文件的存储路径,而且后面的路径必须事先创建好，必须已经存在，否则服务开启失败</p></li> <li><p>注意：这个命令窗体绝对不能关,关闭这个窗口就相当于停止了mongodb服务</p></li></ul> <h2 id="_4-添加到window服务"><a href="#_4-添加到window服务" class="header-anchor">#</a> 4. 添加到window服务</h2> <ul><li>以管理员身份运行命令</li> <li>logfile是一个不存在的文件名，而非目录名</li> <li>mongod.exe --logpath C:\program1\MongoDB\bin\log\logfile --logappend --dbpath C:\program1\MongoDB\bin\data --serviceName MongoDB --install</li></ul> <h2 id="_4-mongodb基本概念"><a href="#_4-mongodb基本概念" class="header-anchor">#</a> 4. MongoDB基本概念</h2> <ul><li>数据库 MongoDB的单个实例可以容纳多个独立的数据库，比如一个学生管理系统就可以对应一个数据库实例</li> <li>集合 数据库是由集合组成的,一个集合用来表示一个实体,如学生集合</li> <li>文档 集合是由文档组成的，一个文档表示一条记录,比如一位同学张三就是一个文档</li> <li>mongostat</li></ul> <h2 id="_5-数据库操作"><a href="#_5-数据库操作" class="header-anchor">#</a> 5. 数据库操作</h2> <h3 id="_5-1-使用数据库"><a href="#_5-1-使用数据库" class="header-anchor">#</a> 5.1 使用数据库</h3> <p>语法</p> <ul><li>use database_name</li> <li>database_name 代表数据库的名字</li> <li>注：如果此数据库存在，则切换到此数据库下,如果此数据库还不存在也可以切过来,但是并不能立刻创建数据库</li> <li>切换到 school数据库下</li></ul> <p>use school</p> <h3 id="_5-2-查看所有数据库"><a href="#_5-2-查看所有数据库" class="header-anchor">#</a> 5.2 查看所有数据库</h3> <p>语法</p> <ul><li>show dbs</li> <li>备注: 我们刚创建的数据库school如果不在列表内， 要显示它，我们需要向school数据库插入一些数据</li> <li>db.students.insert({name:'zfpx',age:1});</li></ul> <h3 id="_5-3-查看当前使用的数据库"><a href="#_5-3-查看当前使用的数据库" class="header-anchor">#</a> 5.3 查看当前使用的数据库</h3> <p>语法</p> <ul><li>db</li> <li>注：db代表的是当前数据库 也就是school这个数据库</li></ul> <h3 id="_5-4-删除数据库"><a href="#_5-4-删除数据库" class="header-anchor">#</a> 5.4 删除数据库</h3> <p>语法</p> <p>db.dropDatabase()</p> <h2 id="_6-集合操作"><a href="#_6-集合操作" class="header-anchor">#</a> 6. 集合操作</h2> <h3 id="_6-1-查看集合帮助"><a href="#_6-1-查看集合帮助" class="header-anchor">#</a> 6.1 查看集合帮助</h3> <p>语法</p> <p>db.students.help();</p> <h3 id="_6-2-查看数据库下的集合"><a href="#_6-2-查看数据库下的集合" class="header-anchor">#</a> 6.2 查看数据库下的集合</h3> <p>show collections</p> <h3 id="_6-3-创建集合"><a href="#_6-3-创建集合" class="header-anchor">#</a> 6.3 创建集合</h3> <h4 id="_6-3-1-创建一个空集合"><a href="#_6-3-1-创建一个空集合" class="header-anchor">#</a> 6.3.1 创建一个空集合</h4> <p>db.createCollection(collection_Name)<br>
collection_Name集合的名称</p> <h4 id="_6-3-2-创建集合并插入一个文档"><a href="#_6-3-2-创建集合并插入一个文档" class="header-anchor">#</a> 6.3.2 创建集合并插入一个文档</h4> <p>collection_Name集合的名称
document要插入的文档
db.collection_Name.insert(document)</p> <h2 id="_7-插入文档"><a href="#_7-插入文档" class="header-anchor">#</a> 7. 插入文档</h2> <h3 id="_7-1-insert"><a href="#_7-1-insert" class="header-anchor">#</a> 7.1 insert</h3> <p>db.collection_name.insert(document);
`
collection_name 集合的名字
document 插入的文档
每当插入一条新文档的时候mongodb会自动为此文档生成一个_id属性,_id一定是唯一的，用来唯一标识一个文档 _id也可以直接指定，但如果数据库中此集合下已经有此_id的话插入会失败
db.students.insert({_id:1,name:'zfpx',age:1});
WriteResult({ &quot;nInserted&quot; : 1 })
db.students.insert({_id:1,name:'zfpx',age:1});</p> <h3 id="_7-2-save"><a href="#_7-2-save" class="header-anchor">#</a> 7.2 save</h3> <p>db.collection_name.save(document)
collection_name 集合的名字
document 插入的文档
注：如果不指定 _id 字段 save() 方法类似于 insert() 方法。如果指定 _id 字段，则会更新该 _id 的数据。</p> <blockquote><p>db.students.save({_id:1,name:'zfpx',age:1});
WriteResult({ &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 0 })
db.students.save({_id:1,name:'zfpx',age:100});
WriteResult({ &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 })</p></blockquote> <h2 id="_8-更新文档"><a href="#_8-更新文档" class="header-anchor">#</a> 8. 更新文档</h2> <h3 id="_8-1-语法"><a href="#_8-1-语法" class="header-anchor">#</a> 8.1 语法</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   <span class="token operator">&lt;</span>updateObj<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   {
     upsert: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
     multi: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_8-2-参数"><a href="#_8-2-参数" class="header-anchor">#</a> 8.2 参数</h3> <ul><li>query 查询条件,指定要更新符合哪些条件的文档</li> <li>update 更新后的对象或指定一些更新的操作符</li> <li>$set直接指定更新后的值</li> <li>$inc在原基础上累加</li> <li>upsert 可选，这个参数的意思是，如果不存在符合条件的记录时是否插入updateObj. 默认是false,不插入。</li> <li>multi 可选，mongodb 默认只更新找到的第一条记录，如果这个参数为true,就更新所有符合条件的记录。</li></ul> <h3 id="_8-3-upsert"><a href="#_8-3-upsert" class="header-anchor">#</a> 8.3 upsert</h3> <p>将students集合中数据中name是zfpx2的值修改为zfpx22</p> <blockquote><p>db.students.insert({_id:1,name:'zfpx1'});
WriteResult({ &quot;nInserted&quot; : 1 })
db.students.update({_id:2},{name:'zfpx2'},{upsert:true});
WriteResult({ &quot;nMatched&quot; : 0, &quot;nUpserted&quot; : 1, &quot;nModified&quot; : 0, &quot;_id&quot; : 2 })</p></blockquote> <h3 id="_8-4-multi"><a href="#_8-4-multi" class="header-anchor">#</a> 8.4 multi</h3> <ul><li>如果有多条name是zfpx2的数据只更新一条,如果想全部更新需要指定{multi:true}的参数</li> <li>db.students.update({name:'zfpx2'},{$set:{age:10}},{multi:true});</li> <li>WriteResult({ &quot;nMatched&quot; : 2, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 2 });</li></ul> <h2 id="_9-更新操作符"><a href="#_9-更新操作符" class="header-anchor">#</a> 9. 更新操作符</h2> <h3 id="_9-1-set"><a href="#_9-1-set" class="header-anchor">#</a> 9.1 $set</h3> <p>直接指定更新后的值</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>c3<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx2'</span>}<span class="token punctuation">,</span>{$<span class="token keyword">set</span>:{age:<span class="token number">10</span>}}<span class="token punctuation">,</span>{multi:<span class="token boolean">true</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-2-inc"><a href="#_9-2-inc" class="header-anchor">#</a> 9.2 $inc</h3> <p>在原基础上累加</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>c3<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx2'</span>}<span class="token punctuation">,</span>{$inc:{age:<span class="token number">1</span>}}<span class="token punctuation">,</span>{multi:<span class="token boolean">true</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-3-unset"><a href="#_9-3-unset" class="header-anchor">#</a> 9.3 $unset</h3> <p>删除指定的键</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>c3<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx2'</span>}<span class="token punctuation">,</span>{$unset:{age:<span class="token number">1</span>}}<span class="token punctuation">,</span>{multi:<span class="token boolean">true</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-4-push"><a href="#_9-4-push" class="header-anchor">#</a> 9.4 $push</h3> <p>向数组中添加元素</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>var result <span class="token operator">=</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'张三'</span>}<span class="token punctuation">,</span>{
    $push:{<span class="token string">&quot;hobbys&quot;</span>:<span class="token string">&quot;smoking&quot;</span>}
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_9-5-ne"><a href="#_9-5-ne" class="header-anchor">#</a> 9.5 $ne</h3> <p>$ne类似于MYSQL的 not in 或者not exists</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span><span class="token punctuation">,</span>hobbys:{$ne:<span class="token string">'smoking'</span>}}<span class="token punctuation">,</span>{$push:{<span class="token string">&quot;hobbys&quot;</span>:<span class="token string">&quot;smoking&quot;</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-5-addtoset"><a href="#_9-5-addtoset" class="header-anchor">#</a> 9.5 $addToSet</h3> <p>向集合中添加元素</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span>}<span class="token punctuation">,</span>{$addToSet:{<span class="token string">&quot;hobbys&quot;</span>:<span class="token string">&quot;smoking&quot;</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-6-pull"><a href="#_9-6-pull" class="header-anchor">#</a> 9.6 $pull</h3> <p>向集合中删除元素</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span>}<span class="token punctuation">,</span>{$pull:{<span class="token string">&quot;hobbys&quot;</span>:<span class="token string">&quot;smoking&quot;</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-7-each"><a href="#_9-7-each" class="header-anchor">#</a> 9.7 $each</h3> <p>把数组中的元素逐个添加到集合中</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>var hobbys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span>}<span class="token punctuation">,</span>{$addToSet:{hobbys:{$each:hobbys}}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_9-8-pop"><a href="#_9-8-pop" class="header-anchor">#</a> 9.8 $pop</h3> <p>从数组中移除指定的索引中对应的元素</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span>}<span class="token punctuation">,</span>{$pop:{hobbys:<span class="token number">1</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_9-9-修改指定索引元素"><a href="#_9-9-修改指定索引元素" class="header-anchor">#</a> 9.9 修改指定索引元素</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>c3<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>{name:<span class="token string">'zfpx1'</span>}<span class="token punctuation">,</span>{$<span class="token keyword">set</span>:{<span class="token string">&quot;hobbys.0&quot;</span>:<span class="token string">&quot;smoking2&quot;</span>}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_10-文档的删除"><a href="#_10-文档的删除" class="header-anchor">#</a> 10. 文档的删除</h2> <p>remove方法是用来移除集合中的数据</p> <h3 id="_10-1-语法"><a href="#_10-1-语法" class="header-anchor">#</a> 10.1 语法</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   {
     justOne: <span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">&gt;</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_10-2-参数"><a href="#_10-2-参数" class="header-anchor">#</a> 10.2 参数</h3> <ul><li>query :（可选）删除的文档的条件。</li> <li>justOne : （可选）如果设为 true 或 1，则只删除匹配到的多个文档中的第一个</li></ul> <h3 id="_10-3-实例"><a href="#_10-3-实例" class="header-anchor">#</a> 10.3 实例</h3> <p>删除worker集合里name是zfpx2的所有文档数据</p> <blockquote><p>db.students.remove({name:'zfpx2'});
WriteResult({ &quot;nRemoved&quot; : 2 })
即使匹配多条也只删除一条</p></blockquote> <blockquote><p>db.students.remove({name:&quot;zfpx2&quot;},{justOne:true})</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>WriteResult<span class="token punctuation">(</span>{ <span class="token string">&quot;nRemoved&quot;</span> : <span class="token number">1</span> }<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_11-查询文档"><a href="#_11-查询文档" class="header-anchor">#</a> 11. 查询文档</h2> <h3 id="_11-1-find"><a href="#_11-1-find" class="header-anchor">#</a> 11.1 find</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collection_name 集合的名字
实例 查询students下所有的文档</p> <p>db.students.find()</p> <h3 id="_11-2-查询指定列"><a href="#_11-2-查询指定列" class="header-anchor">#</a> 11.2 查询指定列</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{queryWhere}<span class="token punctuation">,</span>{<span class="token keyword">key</span>:<span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">key</span>:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数列表</p> <p>collection_name 集合的名字
queryWhere 参阅查询条件操作符
key 指定要返回的列
1 表示要显示
实例 只返回显示age列</p> <blockquote><p>db.students.find({},{age:1});</p></blockquote> <h3 id="_11-3-findone"><a href="#_11-3-findone" class="header-anchor">#</a> 11.3 findOne</h3> <p>查询匹配结果的第一条数据 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>实例</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-4-in"><a href="#_11-4-in" class="header-anchor">#</a> 11.4 $in</h3> <p>查询字段在某个范围内</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$<span class="token operator">in</span>:<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span>}}<span class="token punctuation">,</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-5-nin"><a href="#_11-5-nin" class="header-anchor">#</a> 11.5 $nin</h3> <p>查询字段不在某个范围内</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$nin:<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span>}}<span class="token punctuation">,</span>{name:<span class="token number">1</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-6-not"><a href="#_11-6-not" class="header-anchor">#</a> 11.6 $not</h3> <p>对特定条件取反</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$<span class="token operator">not</span>:{$gte:<span class="token number">20</span><span class="token punctuation">,</span>$lte:<span class="token number">30</span>}}}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_11-7-array"><a href="#_11-7-array" class="header-anchor">#</a> 11.7 array</h3> <p>对数组的查询</p> <p>//按所有元素匹配
//let result = db.student.find({friends:[ &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot; ]});
//匹配一项 包含A的就可以
//let result = db.student.find({friends:&quot;A&quot;});
//$all 必须同时包含A B
//let result = db.student.find({friends:{$all:['A',&quot;B&quot;]}});
//$in 或者关系 ，包含A或者B
//let result = db.student.find({friends:{$in:['A',&quot;B&quot;]}});
//$size 按数组的长度去匹配
//let result = db.student.find({friends:{$size:4}});
//$slice 只返回数组中的某一部分
//let result = db.student.find({friends:{$size:5}},{name:1,friends:{$slice:2}});
//let result = db.student.find({friends:{$size:5}},{name:1,friends:{$slice:-2}});
$slice:[&quot;$array&quot;, [startIndex, ] length ] （startIndex可以省略，默认从0开始）
&quot;friends&quot; : [ &quot;A&quot;, &quot;B&quot; ] }   &quot;friends&quot; : [ &quot;C&quot;, &quot;D&quot; ]
db.stu.find({},{friends:{$slice:[0,3]}});  &quot;friends&quot; : [ &quot;A&quot;, &quot;B&quot;, &quot;C&quot; ]</p> <h3 id="_11-8-where"><a href="#_11-8-where" class="header-anchor">#</a> 11.8 where</h3> <p>db.student.find({$where:&quot;this.age&gt;30&quot;},{name:1,age:1});</p> <h3 id="_11-9-cursor"><a href="#_11-9-cursor" class="header-anchor">#</a> 11.9 cursor</h3> <p>游标不是查询结果，而是查询的一个返回资源或者接口，通过这个接口，可以逐条读取数据
var result = db.student.find();</p> <p>//while(result.hasNext()){
//    printjson(result.next());
//}</p> <h2 id="_12-条件操作符"><a href="#_12-条件操作符" class="header-anchor">#</a> 12. 条件操作符</h2> <p>条件操作符用于比较两个表达式并从mongoDB集合中获取数据</p> <h3 id="_12-1-大于操作符"><a href="#_12-1-大于操作符" class="header-anchor">#</a> 12.1 大于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gt:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
查询 age 大于 30的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age:{$gt:<span class="token number">30</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-2-大于等于操作符"><a href="#_12-2-大于等于操作符" class="header-anchor">#</a> 12.2 大于等于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
查询age 3大于等于30 的数据</p> <p>db.students.find({age: {$gte: 30}})</p> <h3 id="_12-3-小于操作符"><a href="#_12-3-小于操作符" class="header-anchor">#</a> 12.3 小于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span> {<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lt:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name集合名称
key 字段
value 值
实例</p> <p>db.students.find({age: {$lt: 30}}) 查询age 小于30的数据</p> <h3 id="_12-4-小于等于操作符"><a href="#_12-4-小于等于操作符" class="header-anchor">#</a> 12.4 小于等于操作符</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name集合名词
key字段
value值
查询age 小于等于30的数据</p> <p>db.students.find({age: {$lte: 30}})</p> <h3 id="_12-5-同时使用-gte和-lte"><a href="#_12-5-同时使用-gte和-lte" class="header-anchor">#</a> 12.5 同时使用 $gte和$lte</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$gte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}<span class="token punctuation">,</span><span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:{$lte:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
实例 查询age 大于等于 30 并且 age 小于等于 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{age: {$gte: <span class="token number">30</span><span class="token punctuation">,</span> $lte: <span class="token number">50</span>}}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-6-等于"><a href="#_12-6-等于" class="header-anchor">#</a> 12.6 等于</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token operator">&lt;</span><span class="token keyword">key</span><span class="token operator">&gt;</span>:<span class="token operator">&lt;</span><span class="token keyword">value</span><span class="token operator">&gt;</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name集合名词
key字段
value值
查询age = 30的数据</p> <p>db.students.find({&quot;age&quot;: 30})`</p> <h3 id="_12-7-使用-id进行查询"><a href="#_12-7-使用-id进行查询" class="header-anchor">#</a> 12.7 使用 _id进行查询</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token string">&quot;_id&quot;</span> : ObjectId<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>value _id的值
实例 查询_id是 562af23062d5a57609133974 数据</p> <blockquote><p>db.students.find({_id:ObjectId(&quot;5adb666ecd738e9771638985&quot;)});</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>{ <span class="token string">&quot;_id&quot;</span> : ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5adb666ecd738e9771638985&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span> : <span class="token string">&quot;zzzz&quot;</span> }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-8-查询结果集的条数"><a href="#_12-8-查询结果集的条数" class="header-anchor">#</a> 12.8 查询结果集的条数</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
实例</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_12-9-正则匹配"><a href="#_12-9-正则匹配" class="header-anchor">#</a> 12.9 正则匹配</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token operator">/</span><span class="token keyword">value</span><span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
key 字段
value 值
实例 查询name里包含zhang的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token operator">/</span><span class="token keyword">value</span><span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询某个字段的值当中是否以另一个值开头</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token operator">/</span><span class="token operator">^</span>zhang<span class="token operator">/</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_13-与和或"><a href="#_13-与和或" class="header-anchor">#</a> 13. 与和或</h2> <h3 id="_13-1-and"><a href="#_13-1-and" class="header-anchor">#</a> 13.1 and</h3> <p>find方法可以传入多个键(key)，每个键(key)以逗号隔开</p> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{key1:value1<span class="token punctuation">,</span> key2:value2}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>实例 查询name是zfpx并且age是1的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">'zfpx'</span><span class="token punctuation">,</span>age:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_13-2-or"><a href="#_13-2-or" class="header-anchor">#</a> 13.2 or</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>
   {
      $<span class="token operator">or</span>: <span class="token punctuation">[</span>
   {key1: value1}<span class="token punctuation">,</span> {key2:value2}
      <span class="token punctuation">]</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>实例 查询age = 30 或者 age = 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:<span class="token number">30</span>}<span class="token punctuation">,</span>{age:<span class="token number">50</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_13-3-and和or联用"><a href="#_13-3-and和or联用" class="header-anchor">#</a> 13.3 and和or联用</h3> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collection_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span>
   {
     key1:value1<span class="token punctuation">,</span>
     key2:value2<span class="token punctuation">,</span>
     $<span class="token operator">or</span>: <span class="token punctuation">[</span>
   {key1: value1}<span class="token punctuation">,</span>
   {key2:value2}
     <span class="token punctuation">]</span>
   }
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>实例 查询 name是zfpx 并且 age是30 或者 age是 50 的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span>{name:<span class="token string">'zfpx'</span><span class="token punctuation">,</span>$<span class="token operator">or</span>:<span class="token punctuation">[</span>{age:<span class="token number">30</span>}<span class="token punctuation">,</span>{age:<span class="token number">50</span>}<span class="token punctuation">]</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_14-分页查询"><a href="#_14-分页查询" class="header-anchor">#</a> 14. 分页查询</h2> <h3 id="_14-1-limit"><a href="#_14-1-limit" class="header-anchor">#</a> 14.1 limit</h3> <p>读取指定数量的数据记录 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name集合
number读取的条数
实例 查询前3条数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-2-skip"><a href="#_14-2-skip" class="header-anchor">#</a> 14.2 skip</h3> <p>跳过指定数量的数据，skip方法同样接受一个数字参数作为跳过的记录条数 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>number<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name集合
number跳过的条数
实例 查询3条以后的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-3-skip-limit"><a href="#_14-3-skip-limit" class="header-anchor">#</a> 14.3 skip+limit</h3> <p>通常用这种方式来实现分页功能 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>skipNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>limitNum<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数</p> <p>collectoin_name 集合名称
skipNum 跳过的条数
limitNum 限制返回的条数
实例 查询在4-6之间的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14-4-sort排序"><a href="#_14-4-sort排序" class="header-anchor">#</a> 14.4 sort排序</h3> <p>sort()方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而-1是用于降序排列。 语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token number">1</span>}<span class="token punctuation">)</span>
db<span class="token punctuation">.</span>collectoin_name<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{<span class="token keyword">key</span>:<span class="token operator">-</span><span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>参数</p> <p>collectoin_name集合
key表示字段
实例 查询出并升序排序 {age:1} age表示按那个字段排序 1表示升序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span>{age:<span class="token number">1</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_15-执行脚本"><a href="#_15-执行脚本" class="header-anchor">#</a> 15. 执行脚本</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token string">'zfpx'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> username<span class="token punctuation">,</span> <span class="token string-property property">&quot;password&quot;</span><span class="token operator">:</span> password <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'students'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//选择users数据库</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'write '</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'students'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zfpx&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> cost <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'cost '</span> <span class="token operator">+</span> cost <span class="token operator">+</span> <span class="token string">' ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'students'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zfpx&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cost <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'cost '</span> <span class="token operator">+</span> cost <span class="token operator">+</span> <span class="token string">' ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>在命令行中执行</p> <p>script&gt;mongo 1.js
MongoDB shell version: 2.6.7
connecting to: test
connecting to: students
write WriteResult({ &quot;nInserted&quot; : 1 })</p> <h2 id="_16-备份与导出"><a href="#_16-备份与导出" class="header-anchor">#</a> 16. 备份与导出</h2> <p>mongodump
-- host 127.0.0.1
-- port 27017
-- out D:/databack/backup
-- collection mycollection
-- db test
-- username
-- password
//mongodump --host 127.0.0.1 --port 27017 --out ./backup --collection users --db students
//db.users.drop();</p> <p>mongorestore
--host
--port
--username
--password</p> <p>// mongorestore --host 127.0.0.1 --port 27017 ./backup</p> <h2 id="_17-权限"><a href="#_17-权限" class="header-anchor">#</a> 17. 权限</h2> <h3 id="_17-1-创建用户"><a href="#_17-1-创建用户" class="header-anchor">#</a> 17.1 创建用户</h3> <p>使用use admin进入我们的admin库
使用db.createUser方法来创建集合</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
    <span class="token keyword">user</span>:<span class="token string">'zfpx'</span><span class="token punctuation">,</span>
    pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
    customData:{
        name:<span class="token string">'zhufengpeixun'</span><span class="token punctuation">,</span>
        email:<span class="token string">'zhufengpeixun@126.com'</span><span class="token punctuation">,</span>
        age:<span class="token number">9</span>
    }<span class="token punctuation">,</span>
    roles:<span class="token punctuation">[</span>
        {
          role:<span class="token string">'readWrite'</span><span class="token punctuation">,</span>
          db:<span class="token string">'school'</span>
        }<span class="token punctuation">,</span>
        <span class="token string">'read'</span>
    <span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_17-2-查询用户"><a href="#_17-2-查询用户" class="header-anchor">#</a> 17.2 查询用户</h3> <p>db.system.users.find();</p> <h3 id="_17-3-删除用户"><a href="#_17-3-删除用户" class="header-anchor">#</a> 17.3 删除用户</h3> <p>db.system.users.remove({user:'zfpx'});</p> <h3 id="_17-4-启动数据库权限检查"><a href="#_17-4-启动数据库权限检查" class="header-anchor">#</a> 17.4 启动数据库权限检查</h3> <p>mongod --auth
mongo  -u zfpx -p 123456 127.0.0.1:27017/admin</p> <h3 id="_17-5-鉴权"><a href="#_17-5-鉴权" class="header-anchor">#</a> 17.5 鉴权</h3> <p>use admin;
db.auth('zfpx','zfpx');
正确返回1，如果错误返回0</p> <h2 id="_18-索引"><a href="#_18-索引" class="header-anchor">#</a> 18. 索引</h2> <h3 id="_18-1-准备数据"><a href="#_18-1-准备数据" class="header-anchor">#</a> 18.1 准备数据</h3> <p>var db = connect('school');//选择users数据库
var users = [];
for(var i=0;i&lt;20;i++){
users.push({_id:i,name:'zfpx'+i});
}
print(users.length);
db.users.insert(users);</p> <h3 id="_18-2-打印出查询时间"><a href="#_18-2-打印出查询时间" class="header-anchor">#</a> 18.2 打印出查询时间</h3> <p>var startTime = Date.now();
var  db = connect('school');<br>
var  records=db.users.find({name:&quot;zfpx100&quot;});
records.forEach(function(item){printjson(item)});
print(Date.now() - startTime);</p> <h3 id="_18-3-建立索引"><a href="#_18-3-建立索引" class="header-anchor">#</a> 18.3 建立索引</h3> <p>db.users.ensureIndex({name:1});</p> <h2 id="_19-附录"><a href="#_19-附录" class="header-anchor">#</a> 19. 附录</h2> <h3 id="_19-1-objectid构成"><a href="#_19-1-objectid构成" class="header-anchor">#</a> 19.1 ObjectId构成</h3> <p>之前我们使用MySQL等关系型数据库时，主键都是设置成自增的。但在分布式环境下，这种方法就不可行了，会产生冲突。为此，MongoDB采用了一个称之为ObjectId的类型来做主键。ObjectId是一个12字节的 BSON 类型字符串。按照字节顺序，一次代表：</p> <p>4字节：UNIX时间戳
3字节：表示运行MongoDB的机器
2字节：表示生成此_id的进程
3字节：由一个随机数开始的计数器生成的值</p> <h3 id="_19-2-mongodb启动命令mongod参数说明"><a href="#_19-2-mongodb启动命令mongod参数说明" class="header-anchor">#</a> 19.2 Mongodb启动命令mongod参数说明</h3> <p>选项	含义
--port	指定服务端口号，默认端口27017
--logpath	指定MongoDB日志文件，注意是指定文件不是目录
--logappend	使用追加的方式写日志
--dbpath	指定数据库路径
--directoryperdb	设置每个数据库将被保存在一个单独的目录</p> <h3 id="_19-3-集合命令"><a href="#_19-3-集合命令" class="header-anchor">#</a> 19.3 集合命令</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>help<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
DBCollection help
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>help<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">show</span> DBCursor help 显示游标帮助
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 显示条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>copyTo<span class="token punctuation">(</span>newColl<span class="token punctuation">)</span> <span class="token operator">-</span> duplicates collection <span class="token keyword">by</span> copying <span class="token keyword">all</span> docum ents <span class="token keyword">to</span> newColl<span class="token punctuation">;</span> <span class="token keyword">no</span> indexes are copied<span class="token punctuation">.</span> 把一个旧集合拷贝到一个新的集合，不拷贝索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>convertToCapped<span class="token punctuation">(</span>maxBytes<span class="token punctuation">)</span> <span class="token operator">-</span> calls {convertToCapped:<span class="token string">'students '</span><span class="token punctuation">,</span> size:maxBytes}} command
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dataSize<span class="token punctuation">(</span><span class="token punctuation">)</span> 数据大小
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">distinct</span><span class="token punctuation">(</span> <span class="token keyword">key</span> <span class="token punctuation">)</span> <span class="token operator">-</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">distinct</span><span class="token punctuation">(</span> <span class="token string">'x'</span> <span class="token punctuation">)</span> 统计唯一的<span class="token keyword">key</span>的数量
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">drop</span> the collection ，删除集合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span><span class="token keyword">index</span><span class="token punctuation">)</span> <span class="token operator">-</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span> <span class="token string">&quot;indexName&quot;</span> <span class="token punctuation">)</span> 删除索引 <span class="token operator">or</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span> { <span class="token string">&quot;indexKey&quot;</span> : <span class="token number">1</span> } <span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span> 删除 所有的索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>ensureIndex<span class="token punctuation">(</span>keypattern<span class="token punctuation">[</span><span class="token punctuation">,</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> options <span class="token operator">is</span> an object wit h these possible <span class="token keyword">fields</span>: name<span class="token punctuation">,</span> <span class="token keyword">unique</span><span class="token punctuation">,</span> dropDups 添加索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>reIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">[</span>query<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token keyword">fields</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> query <span class="token operator">is</span> an optional query filter<span class="token punctuation">.</span> <span class="token keyword">fields</span> <span class="token operator">is</span> optional <span class="token keyword">set</span> <span class="token keyword">of</span> <span class="token keyword">fields</span> <span class="token keyword">to</span> <span class="token keyword">return</span><span class="token punctuation">.</span> 查找文档
     e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span> {x:
<span class="token number">77</span>} <span class="token punctuation">,</span> {name:<span class="token number">1</span><span class="token punctuation">,</span> x:<span class="token number">1</span>} <span class="token punctuation">)</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 数量
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">limit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> 限制返回的条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>skip<span class="token punctuation">(</span>n<span class="token punctuation">)</span> 设置跳过的条数
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 排序
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findOne<span class="token punctuation">(</span><span class="token punctuation">[</span>query<span class="token punctuation">]</span><span class="token punctuation">)</span> 查找一条
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>findAndModify<span class="token punctuation">(</span> { <span class="token keyword">update</span> : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> remove : <span class="token keyword">bool</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> query: {}<span class="token punctuation">,</span> sort: {}<span class="token punctuation">,</span> <span class="token string">'new'</span>: <span class="token boolean">false</span><span class="token punctuation">]</span> } <span class="token punctuation">)</span> 查找并且修改 更新后的值，是否删除，查询条件 排序 是否返回新值
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getDB<span class="token punctuation">(</span><span class="token punctuation">)</span> get DB object associated <span class="token keyword">with</span> collection 获得DB
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getPlanCache<span class="token punctuation">(</span><span class="token punctuation">)</span> get query <span class="token keyword">plan</span> cache associated <span class="token keyword">with</span> collecti <span class="token keyword">on</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span> 获取索引
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">(</span> { <span class="token keyword">key</span> : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> initial: <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> reduce : <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">,</span> cond: <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> } <span class="token punctuation">)</span> 分组统计
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">insert</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 插入文档
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>mapReduce<span class="token punctuation">(</span> mapFunction <span class="token punctuation">,</span> reduceFunction <span class="token punctuation">,</span> <span class="token punctuation">)</span> 统计
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span> <span class="token punctuation">[</span>pipeline<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">-</span> performs an agg regation <span class="token keyword">on</span> a collection<span class="token punctuation">;</span> <span class="token keyword">returns</span> a <span class="token keyword">cursor</span> 聚合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>query<span class="token punctuation">)</span> 删除
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>renameCollection<span class="token punctuation">(</span> newName <span class="token punctuation">,</span> <span class="token punctuation">)</span> renames the colle ction<span class="token punctuation">.</span> 重命名集合
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>runCommand<span class="token punctuation">(</span> name <span class="token punctuation">,</span> <span class="token punctuation">)</span> runs a db command <span class="token keyword">with</span> the gi ven name <span class="token keyword">where</span> the <span class="token keyword">first</span> param <span class="token operator">is</span> the collection name
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">save</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> 保存对象
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>stats<span class="token punctuation">(</span><span class="token punctuation">)</span> 统计信息
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>storageSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> includes free space allocated <span class="token keyword">to</span> this collec tion
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>totalIndexSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> size <span class="token operator">in</span> bytes <span class="token keyword">of</span> <span class="token keyword">all</span> the indexes
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>totalSize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> storage allocated <span class="token keyword">for</span> <span class="token keyword">all</span> <span class="token keyword">data</span> <span class="token operator">and</span> indexes
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token keyword">update</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> object<span class="token punctuation">[</span><span class="token punctuation">,</span> upsert_bool<span class="token punctuation">,</span> multi_bool<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> instead o f two flags<span class="token punctuation">,</span> you can pass an object <span class="token keyword">with</span> <span class="token keyword">fields</span>: upsert<span class="token punctuation">,</span> multi 更新
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>validate<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> SLOW
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getShardVersion<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> only <span class="token keyword">for</span> <span class="token keyword">use</span> <span class="token keyword">with</span> sharding
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getShardDistribution<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> prints <span class="token keyword">statistics</span> about <span class="token keyword">data</span> distri bution <span class="token operator">in</span> the cluster
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getSplitKeysForChunks<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> calculates split p oints <span class="token keyword">over</span> <span class="token keyword">all</span> chunks <span class="token operator">and</span> <span class="token keyword">returns</span> splitter <span class="token keyword">function</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>getWriteConcern<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">returns</span> the <span class="token keyword">write</span> concern used <span class="token keyword">for</span> <span class="token keyword">any</span> o perations <span class="token keyword">on</span> this collection<span class="token punctuation">,</span> inherited <span class="token keyword">from</span> server<span class="token operator">/</span>db <span class="token keyword">if</span> <span class="token keyword">set</span>
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>setWriteConcern<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> sets the <span class="token keyword">write</span> conc ern <span class="token keyword">for</span> writes <span class="token keyword">to</span> the collection
db<span class="token punctuation">.</span>students<span class="token punctuation">.</span>unsetWriteConcern<span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token operator">-</span> unsets the <span class="token keyword">write</span> concern <span class="token keyword">for</span> writes <span class="token keyword">to</span> the collection
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_20-用户和权限"><a href="#_20-用户和权限" class="header-anchor">#</a> 20. 用户和权限</h2> <h3 id="_20-1-角色"><a href="#_20-1-角色" class="header-anchor">#</a> 20.1 角色</h3> <h4 id="_20-1-1-数据库用户角色"><a href="#_20-1-1-数据库用户角色" class="header-anchor">#</a> 20.1.1 数据库用户角色</h4> <p>针对每一个数据库进行控制。</p> <ul><li>read :提供了读取所有非系统集合，以及系统集合中的system.indexes, system.js, system.namespaces</li> <li>readWrite: 包含了所有read权限，以及修改所有非系统集合的和系统集合中的system.js的权限</li></ul> <h4 id="_20-1-2-数据库管理角色"><a href="#_20-1-2-数据库管理角色" class="header-anchor">#</a> 20.1.2 数据库管理角色</h4> <p>每一个数据库包含了下面的数据库管理角色。</p> <ul><li>dbOwner：该数据库的所有者，具有该数据库的全部权限。</li> <li>dbAdmin：一些数据库对象的管理操作，但是没有数据库的读写权限。（参考：http://docs.mongodb.org/manual/reference/built-in-roles/#dbAdmin）</li> <li>userAdmin：为当前用户创建、修改用户和角色。拥有userAdmin权限的用户可以将该数据库的任意权限赋予任意的用户。</li></ul> <h4 id="_20-1-3-集群管理权限"><a href="#_20-1-3-集群管理权限" class="header-anchor">#</a> 20.1.3 集群管理权限</h4> <ul><li>admin数据库包含了下面的角色，用户管理整个系统，而非单个数据库。这些权限包含了复制集和共享集群的管理函数。</li> <li>clusterAdmin：提供了最大的集群管理功能。相当于clusterManager, clusterMonitor, and hostManager和dropDatabase的权限组合。</li> <li>clusterManager：提供了集群和复制集管理和监控操作。拥有该权限的用户可以操作config和local数据库（即分片和复制功能）</li> <li>clusterMonitor：仅仅监控集群和复制集。</li> <li>hostManager：提供了监控和管理服务器的权限，包括shutdown节点，logrotate, repairDatabase等。 备份恢复权限：admin数据库中包含了备份恢复数据的角色。包括backup、restore等等。</li></ul> <h4 id="_20-1-4-所有数据库角色"><a href="#_20-1-4-所有数据库角色" class="header-anchor">#</a> 20.1.4 所有数据库角色</h4> <ul><li>admin数据库提供了一个mongod实例中所有数据库的权限角色：</li> <li>readAnyDatabase：具有read每一个数据库权限。但是不包括应用到集群中的数据库。</li> <li>readWriteAnyDatabase：具有readWrite每一个数据库权限。但是不包括应用到集群中的数据库。</li> <li>userAdminAnyDatabase：具有userAdmin每一个数据库权限，但是不包括应用到集群中的数据库。</li> <li>dbAdminAnyDatabase：提供了dbAdmin每一个数据库权限，但是不包括应用到集群中的数据库。</li></ul> <h4 id="_20-1-5-超级管理员权限"><a href="#_20-1-5-超级管理员权限" class="header-anchor">#</a> 20.1.5 超级管理员权限</h4> <p>root: dbadmin到admin数据库、useradmin到admin数据库以及UserAdminAnyDatabase。但它不具有备份恢复、直接操作system.*集合的权限，但是拥有root权限的超级用户可以自己给自己赋予这些权限。</p> <h4 id="_20-1-6-备份恢复角色"><a href="#_20-1-6-备份恢复角色" class="header-anchor">#</a> 20.1.6 备份恢复角色</h4> <p>backup、restore；</p> <h4 id="_20-1-7-内部角色"><a href="#_20-1-7-内部角色" class="header-anchor">#</a> 20.1.7 内部角色</h4> <p>__system</p> <h3 id="_20-2-权限配置"><a href="#_20-2-权限配置" class="header-anchor">#</a> 20.2 权限配置</h3> <ul><li>数据库用户角色 read readWrite</li> <li>数据库管理角色 dbAdmin dbOwner userAdmin</li> <li>集群管理角色 clusterAdmin clusterManager clusterMonitor hostManager</li> <li>备份恢复角色 backup restore</li> <li>所有数据库角色 readAnyDatabase readWriteAnyDatabase userAdminAnyDatabase dbAdminAnyDatabase</li> <li>超级用户角色 root</li></ul> <p>mongod.conf 配置文件</p> <h4 id="_20-2-1-常见命令"><a href="#_20-2-1-常见命令" class="header-anchor">#</a> 20.2.1 常见命令</h4> <p>ps -ef | grep mongo //查看当前进程
/usr/bin/mongod -f /etc/mongod.conf //寻找配置文件
systemctl restart mongod.service //重启mongodb</p> <h4 id="_20-2-2-创建超级管理员"><a href="#_20-2-2-创建超级管理员" class="header-anchor">#</a> 20.2.2 创建超级管理员</h4> <p>show users //显示所有用户</p> <h4 id="_20-2-3-创建用户"><a href="#_20-2-3-创建用户" class="header-anchor">#</a> 20.2.3 创建用户</h4> <p>use admin</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
  <span class="token keyword">user</span>:<span class="token string">'admin'</span><span class="token punctuation">,</span>
  pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
  roles:<span class="token punctuation">[</span>{role:<span class="token string">'root'</span><span class="token punctuation">,</span>db:<span class="token string">'admin'</span>}<span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_20-2-4-管理员登录"><a href="#_20-2-4-管理员登录" class="header-anchor">#</a> 20.2.4 管理员登录</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>mongo admin -u admin -p <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_20-2-5-给每个库创创建一个自己的管理员"><a href="#_20-2-5-给每个库创创建一个自己的管理员" class="header-anchor">#</a> 20.2.5 给每个库创创建一个自己的管理员</h4> <p>use question;</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>{
  <span class="token keyword">user</span>:<span class="token string">'questionadmin'</span><span class="token punctuation">,</span>
  pwd:<span class="token string">'123456'</span><span class="token punctuation">,</span>
  roles:<span class="token punctuation">[</span>{role:<span class="token string">'dbOwner'</span><span class="token punctuation">,</span>db:<span class="token string">'question'</span>}<span class="token punctuation">]</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_20-2-6-删除用户"><a href="#_20-2-6-删除用户" class="header-anchor">#</a> 20.2.6 删除用户</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>dropUser<span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// 删除某个用户,接受字符串参数</span>
db<span class="token punctuation">.</span>dropAllUser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 删除当前库的所有用户</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_20-2-7-更新用户"><a href="#_20-2-7-更新用户" class="header-anchor">#</a> 20.2.7 更新用户</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>updateUser<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span>{pwd:<span class="token string">'password'</span>}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_20-2-8-密码认证"><a href="#_20-2-8-密码认证" class="header-anchor">#</a> 20.2.8 密码认证</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>db<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhoubichuan/web-mongodb/edit/master/src/base/build/10.ui.md" target="_blank" rel="noopener noreferrer">在github上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/6/29 15:12:26</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web-mongodb/base/build/9.utils.html" class="prev">
        更新文档
      </a></span> <span class="next"><a href="/web-mongodb/base/build/11.data.html">
        基础 2
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/web-mongodb/assets/js/app.418d3c31.js" defer></script><script src="/web-mongodb/assets/js/2.1ee4d6d3.js" defer></script><script src="/web-mongodb/assets/js/10.54fb086f.js" defer></script><script src="/web-mongodb/assets/js/3.0c6458ad.js" defer></script>
  </body>
</html>
